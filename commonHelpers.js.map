{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery-list');\nconst searchInput = document.querySelector('.search-input');\n\nlet imageViewer;\nlet currentPage = 1;\nlet per_page = 15;\nlet searchQuery = '';\nconst loader = document.querySelector('#loader')\nconst loadMoreBtn = document.querySelector('#load-more');\nloadMoreBtn.addEventListener('click', loadMore);\nsearchForm.addEventListener('submit', searchImages);\n\nasync function searchImages(event) {\n  event.preventDefault();\n  galleryList.innerHTML = '';\n  loader.classList.add('loader');\n  loadMoreBtn.classList.replace('load-more', 'hidden');\n  searchQuery = searchInput.value;\n\n  currentPage = 1;\n\n  const searchValue = searchInput.value.trim();\n     if (searchValue === '') {\n            iziToast.error({\n            title: '',\n            message: 'Please enter a search query!',\n            position: 'topRight'\n        });\n       loader.classList.remove('loader');\n        return; \n  }\n  \n  try {\n    const data = await fetchImages(searchQuery);\n    if (data.hits.length === 0) {\n      iziToast.error({\n        title: '',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight'\n      });\n    }\n\n    galleryList.innerHTML = createMarkup(data.hits);\n      imageViewer = new SimpleLightbox('.gallery-link', {\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n    imageViewer.refresh();\n    loadMoreBtn.classList.replace('hidden', 'load-more');\n\n    if (data.hits.length < 15) {\n      loadMoreBtn.classList.add('hidden');\n    } else {\n      loadMoreBtn.classList.remove('hidden');\n    }\n  } catch (error) {\n      iziToast.error({\n        title: '',\n        message: error.message,\n        position: 'topRight'\n      });\n\n  } finally {\n        searchForm.reset();\n        loader.classList.remove('loader');\n    }\n};\n\nasync function loadMore() {\n  currentPage++;\n  loadMoreBtn.classList.replace('load-more', 'hidden');\n  loader.classList.add('loader');\n\n  try {\n    const data = await fetchImages(searchQuery);\n    galleryList.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    imageViewer.refresh();\n    loadMoreBtn.classList.replace('hidden', 'load-more');\n\n    const li = galleryList.firstElementChild;\n    const liCoordinates = li.getBoundingClientRect();\n\n    window.scrollBy({\n      top: liCoordinates.height * 2,\n      behavior: 'smooth',\n    });\n    \n    if (currentPage * per_page > data.totalHits) {\n      throw new Error('We\\'re sorry, but you\\'ve reached the end of search results.');\n    }\n  } catch (error) {\n    loadMoreBtn.classList.replace('load-more', 'hidden');\n      iziToast.info({\n        title: '',\n        message: error.message,\n        position: 'topRight',\n      });\n  } finally {\n    loader.classList.remove('loader');\n  }\n}\nasync function fetchImages(query) {\n    const API_KEY = '42343385-eb6c059581ee4f8bb4ee68ac0';\n  const BASE_URL = 'https://pixabay.com/api/';\n  \n    const response = await axios.get(BASE_URL, {\n        params: {\n          key: API_KEY,\n          q: query,\n          image_type: \"photo\",\n          orientation: 'horizontal',\n          safesearch: true,\n          page: currentPage,\n          per_page,\n}\n    });\n    return response.data;\n};\n\nfunction createMarkup(arr) {\n  return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n  <li class=\"gallery-item\">\n  <a href=\"${largeImageURL}\" class=\"gallery-link\">\n      <img src=\"${webformatURL}\" \n           alt=\"${tags}\" \n           class=\"gallery-image\"\n           loading=\"lazy\" \n           width=\"250\"\n           height=\"250\">\n      <div class=\"info\">\n        <div class=\"image-item\">Likes <span class=\"image-elem\">${likes}</span></div>\n        <div class=\"image-item\">Views <span class=\"image-elem\">${views}</span></div>\n        <div class=\"image-item\">Comments <span class=\"image-elem\">${comments}</span></div>\n        <div class=\"image-item\">Downloads <span class=\"image-elem\">${downloads}</span></div>\n  </div>\n</a>\n</li>\n`).join('');\n};"],"names":["searchForm","galleryList","searchInput","imageViewer","currentPage","per_page","searchQuery","loader","loadMoreBtn","loadMore","searchImages","event","iziToast","data","fetchImages","createMarkup","SimpleLightbox","error","liCoordinates","query","API_KEY","BASE_URL","axios","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}